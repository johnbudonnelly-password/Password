<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />

  <!-- Discourage caching of the page -->
  <meta http-equiv="Cache-Control" content="no-store, no-cache, must-revalidate">
  <meta http-equiv="Pragma" content="no-cache">
  <meta http-equiv="Expires" content="0">

  <title>Enter Password</title>

  <style>
    body{
      font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial;
      display:grid;
      place-items:center;
      height:100vh;
      margin:0;
      background:
        linear-gradient(rgba(0,0,0,.35), rgba(0,0,0,.35)),
        url("cosmos.jpeg") center / cover no-repeat fixed;
    }

    .card{
      background:rgba(255,255,255,.96);
      padding:24px;
      border-radius:14px;
      box-shadow:0 10px 30px rgba(0,0,0,.25);
      width:min(420px,92vw);
    }

    h1{
      font-size:18px;
      margin:0 0 12px;
    }

    input{
      width:100%;
      padding:12px 14px;
      border:1px solid #d7dbe7;
      border-radius:10px;
      font-size:16px;
      box-sizing:border-box;
      height:44px;
      line-height:44px;
      outline:none;
      background:#fff;
      -webkit-appearance:none;
      appearance:none;
    }

    button{
      margin-top:12px;
      width:100%;
      padding:12px 14px;
      border:0;
      border-radius:10px;
      font-size:16px;
      cursor:pointer;
    }

    .err{
      margin-top:10px;
      font-size:13px;
      color:#b00020;
      display:none;
    }
  </style>
</head>

<body>
  <div class="card">
    <h1>Protected access to Carey's Bar Ltd</h1>

    <!-- Password-manager suppression + anti-autofill (best-effort) -->
    <input
      id="pw"
      type="password"
      name="gateway-access"
      placeholder="Password"
      autocomplete="new-password"
      autocorrect="off"
      autocapitalize="off"
      spellcheck="false"
      inputmode="none"
      data-lpignore="true"
      data-1p-ignore="true"
      data-bwignore="true"
    />

    <button id="go" type="button">Continue</button>
    <div id="err" class="err">Incorrect password.</div>
  </div>

  <script>
    // CONFIG
    const PASSWORD = "bcjd";
    const DESTINATION = "https://sites.google.com/view/careys-bar-ltd/home";

    const pw = document.getElementById("pw");
    const err = document.getElementById("err");

    // --- Never allow a cached/autofilled value to remain in the field ---
    function clearPasswordField() {
      // Clear immediately
      pw.value = "";
      // Clear again shortly after (covers delayed autofill in some browsers)
      setTimeout(() => { pw.value = ""; }, 50);
      setTimeout(() => { pw.value = ""; }, 250);
      setTimeout(() => { pw.value = ""; }, 1000);
    }

    // Clear on initial load
    clearPasswordField();

    // Clear when page is shown (including back/forward cache restores)
    window.addEventListener("pageshow", () => clearPasswordField());

    // Clear when the tab regains focus (some browsers autofill on focus)
    window.addEventListener("focus", () => clearPasswordField());

    // If a browser/extension injects a value after DOM load, wipe it
    const observer = new MutationObserver(() => {
      if (pw.value) clearPasswordField();
    });
    observer.observe(pw, { attributes: true, attributeFilter: ["value"] });

    function proceed() {
      err.style.display = "none";

      if (pw.value === PASSWORD) {
        clearPasswordField(); // clear immediately on success
        window.location.href = DESTINATION;
      } else {
        clearPasswordField(); // clear immediately on failure
        err.style.display = "block";
      }
    }

    document.getElementById("go").addEventListener("click", proceed);

    pw.addEventListener("keydown", (e) => {
      if (e.key === "Enter") proceed();
    });
  </script>
</body>
</html>
